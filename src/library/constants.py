"""
Module contains reusable constants.
"""
import copy

import astropy.constants
import numpy as np

# simulation-specific
HUBBLE = 0.6774
X_H = 0.76
MIN_SNAP = 8  # First snapshot at which all clusters progenitors exist
# Size of simulation box in ckpc
BOX_SIZES = {
    "TNG300-1": 205000.0 / HUBBLE,
    "TNG-Cluster": 680000.0 / HUBBLE,
}
# Mass that a single tracer particle represents in solar masses
TRACER_MASS = .0007714972250575949 * 1e10 / HUBBLE
# Number of halos with masses > 10^14 solar masses in each simulation
N_CLUSTERS = {
    "TNG-Cluster": 352,
    "TNG300-1": 280,
    "TNG300-2": 278,
    "TNG100-1": 14,
    "TNG100-2": 14,
}

# physical constants (copied to minimize lookup time)
G = copy.copy(astropy.constants.G.cgs.value)
k_B = copy.copy(astropy.constants.k_B.cgs.value)
kpc = copy.copy(astropy.constants.kpc.cgs.value)
m_p = copy.copy(astropy.constants.m_p.cgs.value)
M_sol = copy.copy(astropy.constants.M_sun.cgs.value)

# Simulation redshift map:
# Array of shape (100, 2) where first column is redshift and second
# column is corresponding lookback time in Gyr for Planck15 cosmology)
SNAP_MAP = np.array(
    [
        [20.046490988807516, 13.61969300372921],
        [14.989173240042412, 13.528440652068138],
        [11.980213315300293, 13.429237456778646],
        [10.975643294137885, 13.381792879833737],
        [9.996590466186332, 13.324901693949963],
        [9.388771271940549, 13.282726304145687],
        [9.00233985416247, 13.252545570429172],
        [8.449476294368743, 13.203936465571221],
        [8.012172948865935, 13.160145034547813],
        [7.5951071498715965, 13.11313545493272],
        [7.23627606616736, 13.06788167813637],
        [7.005417045544533, 13.036069111042655],
        [6.491597745667503, 12.956367028385326],
        [6.0107573988449, 12.868367099400551],
        [5.846613747881867, 12.834767804960494],
        [5.5297658079491026, 12.763903463079808],
        [5.227580973127337, 12.687859266522858],
        [4.995933468164624, 12.623045619988389],
        [4.664517702470927, 12.518720468551336],
        [4.428033736605549, 12.43449734334311],
        [4.176834914726472, 12.334465919186378],
        [4.0079451114652676, 12.260159329297029],
        [3.7087742646422353, 12.112145388740657],
        [3.4908613692606485, 11.988813741443362],
        [3.2830330579565246, 11.856620710909047],
        [3.008131071630377, 11.65551400913493],
        [2.8957850057274284, 11.563216488197538],
        [2.7331426173187188, 11.417462136721985],
        [2.5772902716018935, 11.26248615597757],
        [2.4442257045541464, 11.116562756867346],
        [2.3161107439568918, 10.962554785869008],
        [2.207925472383703, 10.820856972510954],
        [2.1032696525957713, 10.67239874510991],
        [2.0020281392528516, 10.516905454990708],
        [1.9040895435327672, 10.354098345699594],
        [1.822689252620354, 10.208514617814723],
        [1.7435705743308647, 10.057171813031863],
        [1.6666695561144653, 9.899890921087586],
        [1.6042345220731056, 9.764158534305574],
        [1.5312390291576135, 9.595527849109244],
        [1.4955121664955557, 9.508808093082258],
        [1.4140982203725216, 9.300078029109516],
        [1.3575766674029972, 9.145394488490771],
        [1.3023784599059653, 8.985942406256642],
        [1.2484726142451428, 8.82162782564168],
        [1.2062580807810006, 8.686613967752699],
        [1.1546027123602154, 8.513320213077956],
        [1.1141505637653806, 8.371011553000804],
        [1.074457894547674, 8.22539283013596],
        [1.035510445664141, 8.0764249992447],
        [0.9972942257819404, 7.92407118631926],
        [0.9505313515850327, 7.728815014618658],
        [0.9230008161779089, 7.6090700062378716],
        [0.8868969375752482, 7.446361290235203],
        [0.8514709006246495, 7.280144228831766],
        [0.8167099790118506, 7.110395347418258],
        [0.7910682489463392, 6.9807535878134095],
        [0.7574413726158526, 6.804777132642012],
        [0.7326361820223115, 6.670446315712607],
        [0.7001063537185233, 6.488198162849202],
        [0.6761104112134777, 6.34915228835458],
        [0.6446418406845371, 6.160607517126755],
        [0.6214287452425136, 6.016835382183121],
        [0.5985432881875667, 5.871038088620611],
        [0.5759808451078874, 5.723217657043053],
        [0.5463921831410221, 5.522982493815958],
        [0.524565820433923, 5.370456348013724],
        [0.5030475232448832, 5.2159229299674434],
        [0.4818329434209512, 5.0593897581712675],
        [0.4609177941806475, 4.900865623537344],
        [0.4402978492477432, 4.740360583177965],
        [0.41996894199726653, 4.577885950511492],
        [0.3999269646135635, 4.4134542816876055],
        [0.38016786726023866, 4.247079358351424],
        [0.36068765726181673, 4.078776166790325],
        [0.3478538418581776, 3.9655107146766633],
        [0.32882972420595435, 3.7940302386810982],
        [0.31007412012783386, 3.6206671507683983],
        [0.2977176845174465, 3.504055285169464],
        [0.2733533465784399, 3.2683708757725562],
        [0.2613432561610123, 3.149310827656876],
        [0.24354018155467028, 2.9692167789871458],
        [0.22598838626019768, 2.7873383509378895],
        [0.21442503551449454, 2.665106445241652],
        [0.19728418237600986, 2.480307294628345],
        [0.1803852617057493, 2.293789024963446],
        [0.1692520332436107, 2.1685012252728164],
        [0.15274876890238098, 1.9791757582518914],
        [0.14187620396956202, 1.8520413162963683],
        [0.12575933241126092, 1.6599839293574086],
        [0.10986994045882548, 1.4663247156724708],
        [0.09940180263022191, 1.3363428020639456],
        [0.08388443079747931, 1.140077804287315],
        [0.07366138465643868, 1.008385770661833],
        [0.058507322794512984, 0.8095967074360965],
        [0.04852362998180593, 0.6762496373572513],
        [0.0337243718735154, 0.47501992566677553],
        [0.023974428382762536, 0.340073891607617],
        [0.009521666967944764, 0.13648821891469304],
        [0.0, 0.0],
    ]
)

# direct access
REDSHIFTS = SNAP_MAP[:, 0]
LOOKBACK_TIMES = SNAP_MAP[:, 1]
